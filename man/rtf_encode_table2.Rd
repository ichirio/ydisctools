% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/r2rtf_tools.R
\name{rtf_encode_table2}
\alias{rtf_encode_table2}
\title{Encode Table to RTF Format with Advanced Features}
\usage{
rtf_encode_table2(tbl, verbose = FALSE)
}
\arguments{
\item{tbl}{A table object with RTF attributes. The table should have been
prepared with appropriate RTF formatting attributes using other r2rtf functions.}

\item{verbose}{A logical value indicating whether to return detailed RTF
components separately. If TRUE, returns a list with individual RTF sections.
If FALSE (default), returns a condensed list with start, body, and end sections.}
}
\value{
If verbose = FALSE, returns a list with three elements:
\describe{
\item{start}{Character string containing RTF initialization code}
\item{body}{Character string containing the main RTF table content}
\item{end}{Character string containing RTF closing code}
}

If verbose = TRUE, returns a detailed list with elements:
\describe{
\item{start}{RTF initialization code}
\item{page}{Page formatting code}
\item{margin}{Margin settings}
\item{header}{Header/title text}
\item{subline}{Subline text}
\item{sublineby}{Subline by grouping variable}
\item{colheader}{Column headers for each page}
\item{body}{Table body content for each page}
\item{footnote}{Footnote text for each page}
\item{source}{Source text for each page}
\item{end}{RTF closing code}
\item{info}{Page and grouping information}
}
}
\description{
This function encodes a table object into Rich Text Format (RTF) with advanced
formatting features including pagination, headers, footers, and sublines.
Based on the r2rtf package functionality by Wang et al. (2020).
}
\details{
This function performs comprehensive RTF encoding of a table object with the following features:
\itemize{
\item Updates first and last border formatting
\item Handles multi-page table layouts with proper pagination
\item Manages page titles, footnotes, and source notes positioning
\item Supports grouping variables with subline headers
\item Applies consistent column headers across pages
\item Integrates fonts, colors, and margin settings
}

The function expects the input table to have specific RTF attributes set by
other r2rtf functions such as page settings, formatting options, and content
specifications.

Page elements positioning:
\itemize{
\item Page titles can be placed on "first", "last", or "all" pages
\item Footnotes can be placed on "first", "last", or "all" pages
\item Source notes can be placed on "first", "last", or "all" pages
}
}
\examples{
\dontrun{
# Assume 'tbl' is a properly formatted table object with RTF attributes

# Basic encoding
rtf_result <- rtf_encode_table2(tbl)
writeLines(paste(rtf_result$start, rtf_result$body, rtf_result$end), "output.rtf")

# Verbose encoding for debugging
rtf_detailed <- rtf_encode_table2(tbl, verbose = TRUE)
str(rtf_detailed)

# Check page information
print(rtf_detailed$info)
}
}
\references{
Wang, S., Ye, S., Anderson, K., & Zhang, Y. (2020). r2rtfâ€”an R Package to
Produce Rich Text Format (RTF) Tables and Figures. PharmaSUG.
\url{https://pharmasug.org/proceedings/2020/DV/PharmaSUG-2020-DV-198.pdf}
}
\seealso{
\code{\link{rtf_encode_table}} for simplified RTF encoding
}
